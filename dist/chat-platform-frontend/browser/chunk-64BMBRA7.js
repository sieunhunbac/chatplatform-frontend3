import{a as O,b as P}from"./chunk-SXLLWFPP.js";import{a as I,b as N,c as F,d as T,e as D,f as k,g as H,h as B,i as V}from"./chunk-VFDU32FN.js";import{B as l,D as d,E as v,I as x,M as y,N as r,O as n,P as p,T as _,U as u,W as C,Z as a,_ as S,aa as c,ba as g,ca as h,ka as M,ma as R,oa as w,sa as E,t as f,u as b,va as A}from"./chunk-LEPOSHV4.js";function j(s,e){if(s&1){let o=_();r(0,"div",12)(1,"div")(2,"span",13),a(3),n(),p(4,"p",14),n(),r(5,"button",15),u("click",function(){let i=f(o).$implicit,m=C();return b(m.enterRoom(i.id))}),a(6," V\xE0o ph\xF2ng "),n()()}if(s&2){let o=e.$implicit;l(3),S(o.name)}}var W=class s{constructor(e,o,t){this.http=e;this.router=o;this.authService=t}rooms=[];roomName="";roomDesc="";API_BASE="https://chatplatform3-11-yl72.onrender.com/api/rooms";ngOnInit(){console.log("\u{1F527} RoomComponent init"),this.authService.loadUserFromStorage();let e=this.authService.getCurrentUserId();if(console.log("adminId:",e),!e){alert("\u274C B\u1EA1n ch\u01B0a \u0111\u0103ng nh\u1EADp!");return}this.loadRooms()}loadRooms(){let e=this.authService.getAuthHeaders();console.log("\u{1F511} Headers khi load rooms:",e.headers.Authorization),this.http.get(this.API_BASE,e).subscribe({next:o=>this.rooms=o||[],error:o=>console.error("\u274C L\u1ED7i load rooms:",o)})}createRoom(){let e=this.authService.getCurrentUserId();if(!e){alert("\u274C B\u1EA1n ch\u01B0a \u0111\u0103ng nh\u1EADp!");return}if(!this.roomName.trim()){alert("\u274C Vui l\xF2ng nh\u1EADp t\xEAn ph\xF2ng!");return}let o={name:this.roomName,description:this.roomDesc,adminId:e},t=this.authService.getAuthHeaders();console.log("\u{1F511} Headers khi t\u1EA1o room:",t.headers.Authorization),this.http.post(this.API_BASE,o,t).subscribe({next:i=>{console.log("\u2705 T\u1EA1o ph\xF2ng th\xE0nh c\xF4ng:",i),this.rooms.push(i),this.roomName="",this.roomDesc=""},error:i=>console.error("\u274C L\u1ED7i t\u1EA1o ph\xF2ng:",i)}),console.log("\u{1F511} Token JWT:",this.authService.getToken())}enterRoom(e){this.router.navigate(["/chat",e])}static \u0275fac=function(o){return new(o||s)(d(w),d(A),d(V))};static \u0275cmp=v({type:s,selectors:[["app-room"]],decls:17,vars:3,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gradient-to-r","from-pink-200","via-purple-200","to-blue-200","px-4"],[1,"max-w-4xl","mx-auto","space-y-8"],[1,"bg-white","rounded-2xl","shadow-md","p-6"],[1,"text-3xl","font-bold","mb-6","text-gray-700","text-center"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["class","flex justify-between items-center p-4 border rounded-lg hover:bg-gray-50",4,"ngFor","ngForOf"],[1,"bg-white","backdrop-blur-md","rounded-2xl","shadow-md","p-6"],[1,"text-2xl","font-semibold","mb-4","text-gray-700"],[1,"space-y-4",3,"ngSubmit"],["name","roomName","placeholder","T\xEAn ph\xF2ng","required","",1,"w-full","px-4","py-3","border","border-gray-300","rounded-xl","focus:outline-none","focus:ring-2","focus:ring-blue-400","focus:border-transparent","bg-gray-50",3,"ngModelChange","ngModel"],["name","roomDesc","placeholder","M\xF4 t\u1EA3 ph\xF2ng","required","",1,"w-full","px-4","py-3","border","border-gray-300","rounded-xl","focus:outline-none","focus:ring-2","focus:ring-blue-400","focus:border-transparent","bg-gray-50",3,"ngModelChange","ngModel"],["type","submit",1,"w-full","bg-green-500","text-white","py-3","rounded-xl","font-semibold","hover:bg-green-600","transition-colors"],[1,"flex","justify-between","items-center","p-4","border","rounded-lg","hover:bg-gray-50"],[1,"text-lg","font-medium"],[1,"text-sm","text-gray-500"],[1,"bg-blue-500","text-white","px-4","py-2","rounded-lg","hover:bg-blue-600","transition-colors",3,"click"]],template:function(o,t){o&1&&(p(0,"app-header"),r(1,"div",0)(2,"div",1)(3,"div",2)(4,"h2",3),a(5,"Danh s\xE1ch ph\xF2ng"),n(),r(6,"div",4),x(7,j,7,1,"div",5),n()(),r(8,"div",6)(9,"h3",7),a(10,"Tham gia / T\u1EA1o ph\xF2ng m\u1EDBi"),n(),r(11,"form",8),u("ngSubmit",function(){return t.createRoom()}),r(12,"input",9),h("ngModelChange",function(m){return g(t.roomName,m)||(t.roomName=m),m}),n(),r(13,"input",10),h("ngModelChange",function(m){return g(t.roomDesc,m)||(t.roomDesc=m),m}),n(),r(14,"button",11),a(15," T\u1EA1o ph\xF2ng "),n()()()()(),p(16,"app-footer")),o&2&&(l(7),y("ngForOf",t.rooms),l(5),c("ngModel",t.roomName),l(),c("ngModel",t.roomDesc))},dependencies:[R,M,B,k,I,N,F,H,D,T,E,O,P],styles:["li[_ngcontent-%COMP%]{cursor:pointer;margin:8px 0;padding:8px;border:1px solid #ccc;border-radius:6px;list-style:none}li[_ngcontent-%COMP%]:hover{background-color:#f0f0f0}"]})};export{W as RoomComponent};
